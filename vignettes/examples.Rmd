---
title: "Examples"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, setup, include = FALSE}
options(rmarkdown.html_vignette.check_title = FALSE)
knitr::opts_chunk$set(
    collapse = TRUE, comment = "#>",
    warning = FALSE, message = FALSE, error = FALSE,
    fig.align = "center", fig.width = 16, fig.height = 9, out.width = "100%"
)

if (!require("microbenchmark")) {
    install.packages("microbenchmark", repos = "https://cloud.r-project.org/")
}
```

```{r, library}
library(LearnNonparam)
```

# Chapter 1

## Example 1.1.2

```{r}
# See ?Quantile or ?onesample.quantile
t <- pmt(
    "onesample.quantile", alternative = "greater",
    prob = 0.5, null_value = 75,
    type = "approx", correct = FALSE
)

# See ?Table1.1.1
t$feed(Table1.1.1)

t$statistic
t$p_value
t$ci
```

## Example 1.2.1

```{r}
# See ?CDF or ?onesample.cdf
t <- pmt("onesample.cdf")

# See ?Table1.2.1
t$feed(Table1.2.1)

t$plot()
```

## Example 1.2.4

```{r}
# See ?Quantile or ?onesample.quantile
t <- pmt(
    "onesample.quantile",
    p = 0.25, null_value = 0, conf_level = 0.90
)

# See ?Table1.2.1
t$feed(Table1.2.1)

t$ci
```

# Chapter 2

## Table 2.1.1

```{r}
# See ?Mean or ?twosample.mean
t <- pmt(
    "twosample.mean", alternative = "greater"
)

# See ?Table2.1.1
t$feed(Table2.1.1)

t$statistic
t$p_value
```

## Table 2.1.1 - wilcoxon

```{r}
# See ?Wilcoxon or ?twosample.wilcoxon
t <- pmt(
    "twosample.wilcoxon", alternative = "greater"
)

# See ?Table2.1.1
t$feed(Table2.1.1)

t$statistic
t$p_value
```

## Example 2.3.1

```{r}
# See ?Mean or ?twosample.mean
t <- pmt(
    "twosample.mean", alternative = "greater"
)

# See ?Table2.3.1
t$feed(Table2.3.1)

t$statistic

# all permutaions
t$p_value

# 1000 permutaions
t$n_permu <- 1000
t$p_value

# install.packages("microbenchmark")
microbenchmark::microbenchmark(
    use_all = {t$n_permu <- NULL},
    use_1000 = {t$n_permu <- 1000}
)
```

## Example 2.6.1

```{r}
# See ?Wilcoxon or ?twosample.wilcoxon
t <- pmt(
    "twosample.wilcoxon", alternative = "greater"
)

# See ?Table2.6.1
t$feed(Table2.6.1)

t$statistic
t$p_value
```

## Example 2.6.2

```{r}
# See ?Wilcoxon or ?twosample.wilcoxon
t <- pmt(
    "twosample.wilcoxon", conf_level = 0.90
)

# See ?Table2.6.2
t$feed(Table2.6.2)

t$estimate
t$ci
```

## Example 2.7.1

```{r}
# See ?ScoreSum or ?twosample.scoresum
t <- pmt(
    "twosample.scoresum", alternative = "greater", scoring = "expon"
)

# See ?Table2.6.2
t$feed(Table2.6.2)

t$statistic
t$p_value
```

## Example 2.8.1

```{r}
# See ?SiegelTukey or ?twosample.siegel
t <- pmt(
    "twosample.siegel", alternative = "greater", type = "approx"
)

# See ?Table2.8.1
t$feed(Table2.8.1)

t$statistic
t$p_value
```

## Example 2.8.2

```{r}
# See ?RatioMeanDeviance or ?twosample.rmd
t <- pmt(
    "twosample.rmd", alternative = "greater"
)

# See ?Table2.8.1
t$feed(Table2.8.1)

t$statistic
t$p_value
```

## Example 2.8.3

```{r}
# See ?KolmogorovSmirnov or ?twosample.ks
t <- pmt(
    "twosample.ks"
)

# See ?Table2.8.1
t$feed(Table2.8.1)

t$statistic
t$p_value
```

# Chapter 3

## Example 3.1.1

```{r}
# See ?ANOVA or ?ksample.anova
t <- pmt(
    "ksample.anova", type = "approx"
)

# See ?Table3.1.2
t$feed(Table3.1.2)

t$statistic
t$p_value

# Change n_permu first,
# otherwise changing type to permu will use all permutations by default,
# which results in an error because there are too many permutations. 
t$n_permu <- 1000
t$type <- "permu"

t$statistic
t$p_value
```

## Example 3.2.1

```{r}
# See ?KruskalWallis or ?ksample.kw
t <- pmt(
    "ksample.kw", type = "approx"
)

# See ?Table3.2.2
t$feed(Table3.2.2)

t$statistic
t$p_value
```

## Example 3.2.2 & 3.2.3

```{r}
# See ?KruskalWallis or ?ksample.kw
t <- pmt(
    "ksample.kw", n_permu = 4000
)

# See ?Table3.2.3
t$feed(Table3.2.3)

t$statistic
t$p_value


t$type <- "approx"
t$p_value


t$scoring <- "expon"

t$n_permu <- 4000
t$type <- "permu"
t$p_value

t$type <- "approx"
t$p_value
```

## Example 3.3.1

```{r}
# See ?MultiCompT or ?multicomp.t
t <- pmt(
    "multicomp.t", n_permu = 5000
)

# See ?Table3.3.1
t$feed(Table3.3.1)

t$print()

t$type <- "approx"
t$print()

t$scoring <- "rank"
t$print()
```

```{r}
# See ?TukeyHSD or ?multicomp.tukey
t <- pmt(
    "multicomp.tukey", n_permu = 5000
)

t$feed(Table3.3.1)

t$print()

t$type <- "approx"
t$print()

t$scoring <- "rank"
t$print()
```

## Example 3.4.1

```{r}
# See ?JonckheereTerpstra or ?ksample.jt
t <- pmt(
    "ksample.jt", alternative = "greater", n_permu = 4000
)

# See ?Table3.4.1
t$feed(Table3.4.1)

t$statistic
t$p_value

t$type <- "approx"
t$p_value
```

# Chapter 4

## Table 4.1.1

```{r}
# See ?SignedDiff or ?paired.signeddiff
t <- pmt(
    "paired.signeddiff", alternative = "greater",
    scoring = "none"
)

# See ?Table4.1.1
t$feed(Table4.1.1)

t$statistic
t$p_value
```

## Example 4.1.1

```{r}
# See ?SignedDiff or ?paired.signeddiff
t <- pmt(
    "paired.signeddiff", alternative = "two_sided",
    scoring = "none", method = "ignore"
)

# See ?Table4.1.3
t$feed(Table4.1.3)

t$statistic
t$p_value

t$n_permu <- 4000
t$p_value

t$type <- "approx"
t$p_value
```

## Example 4.2.1 & 4.2.2

```{r}
# See ?SignedDiff or ?paired.signeddiff
t <- pmt(
    "paired.signeddiff", alternative = "greater",
    scoring = "rank", method = "with_zeros"
)

# See ?Table4.1.1
t$feed(Table4.1.1)

t$statistic
t$p_value

t$type <- "approx"
t$p_value
```

## Table 4.2.3

```{r}
# See ?SignedDiff or ?paired.signeddiff
t <- pmt(
    "paired.signeddiff", alternative = "greater",
    scoring = "rank", method = "ignore"
)

t$feed(data.frame(
    diff = c(-5, -3, -3, 0, 0, 2, 4, 4, 4, 5),
    zero = 0
))

t$statistic
t$p_value
```

## Example 4.3.1

```{r}
# See ?Sign or ?paired.sign
t <- pmt(
    "paired.sign", alternative = "greater", type = "exact"
)

t$feed(data.frame(
    diff = c(rep(+1, 12), rep(-1, 5)),
    zero = 0
))

t$statistic
t$p_value

t$type <- "approx"
t$p_value
```

## Example 4.4.1

```{r}
# See ?RCBDANOVA or ?rcbd.anova
t <- pmt(
    "rcbd.anova", n_permu = 5000
)

# See ?Table4.4.3
t$feed(Table4.4.3)

t$statistic
t$p_value

t$type <- "approx"
t$statistic
t$p_value
```

## Example 4.5.2

```{r}
# See ?Friedman or ?rcbd.friedman
t <- pmt(
    "rcbd.friedman", n_permu = 5000
)

# See ?Table4.5.3
t$feed(Table4.5.3)

t$statistic
t$p_value

t$type <- "approx"
t$statistic
t$p_value
```

## Example 4.6.1

```{r}
# See ?Page or ?rcbd.page
t <- pmt(
    "rcbd.page", alternative = "less", n_permu = 5000
)

# See ?Table4.4.3
t$feed(Table4.4.3)

t$statistic
t$p_value

t$type <- "approx"
t$p_value
```

# Chapter 5

## Example 5.1.1

```{r}
# See ?Correlation or ?association.corr
t <- pmt(
    "association.corr", method = "pearson",
    alternative = "greater", n_permu = 2000
)

# See ?Table5.1.2
t$feed(Table5.1.2)

t$statistic
t$p_value
```

## Example 5.2.1

```{r}
# See ?Correlation or ?association.corr
t <- pmt(
    "association.corr", method = "spearman",
    alternative = "greater", n_permu = 5000
)

# See ?Table5.1.2
t$feed(Table5.1.2)

t$statistic
t$p_value


t$type <- "approx"
t$p_value
```

## Example 5.3.2

```{r}
# See ?Correlation or ?association.corr
t <- pmt(
    "association.corr", method = "kendall",
    alternative = "greater", type = "approx"
)

# See ?Table5.2.2
t$feed(Table5.2.2)

t$statistic
t$p_value
```

## Table 5.4.2

```{r}
# See ?ChiSquare or ?table.chisq
t <- pmt("table.chisq")

# See ?Table5.4.2
t$feed(Table5.4.2)

t$statistic
t$p_value

t$type <- "approx"
t$p_value
```
